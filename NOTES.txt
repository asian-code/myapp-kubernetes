- create security groups for each layer
- ensure multi az RDS with 1 master and others standby
[!] review go services and test api with postman
- setup OIDC with aws and github actions


---
- review helm charts build with pipeline + helm cli commands to use
- deploy ArgoCD
- review istio configuration for services
- setup monitoring and logging with prometheus/grafana


how would the app know what the endpoint for the rds service is? (passed via secrets to eks as a secret which then get injected to the deployment as env variable)


---Order of Operations (Revised)
1. [Infrastructure] Run Terraform:
   - `cd terraform`
   - `terraform apply`
   - Output: VPC, EKS, RDS, ECR, IAM Roles, **ACM Certificate ARN**, **Validation Records**.
   - **Action**: Go to Cloudflare and add the CNAME records from `acm_validation_records` to validate the SSL cert.
   - **Action**: Copy the `acm_certificate_arn`.
   - **Action**: Edit `argocd/applications/infrastructure.yaml` and replace `REPLACE-ME` with the ARN.
   - **Action**: `git commit` and `git push` this change (ArgoCD needs to see it in the repo).

2. [Access] Configure Local Access:
   - `aws eks update-kubeconfig --name myhealth-cluster --region us-east-1`

3. [Prerequisites] Install System Components (Automated via ArgoCD):
   - **ArgoCD**: The GitOps Controller.
     `helm dependency update helm/argocd`
     `helm install argocd helm/argocd -n argocd --create-namespace`
   - **Note**: ArgoCD will now automatically:
     1. Install itself.
     2. Create the `root-app`.
     3. Detect and install **Istio** and **External Secrets Operator** (via `infrastructure.yaml`).
     4. Detect and install your **Apps** (via `platform-and-apps.yaml`).

4. [Secrets] Populate AWS Secrets Manager:
   - Go to AWS Console.
   - Fill in values for `myhealth/db-credentials` (Host, User, Pass from RDS output).
   - Fill in values for `myhealth/oura-credentials` (API Keys).

5. [Images] Build & Push Docker Images:
   - Go to GitHub Actions.
   - Manually trigger "Build Services" workflow (using `workflow_dispatch`).
   - Ensure images exist in ECR.

6. [Verification]
   - Check Pods: `kubectl get pods -A`
   - Check DNS: Configure CNAME for `myhealth.eric-n.com` to Istio LoadBalancer.

---
[!] Critical Gaps to Fix:
- None. All identified gaps have been resolved.



